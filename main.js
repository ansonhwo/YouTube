var videos = [
{
  title: "A Message from President-Elect Donald J. Trump",
  channel: "Transition 2017",
  channelicon: "https://yt3.ggpht.com/-CmoaPOAkgk8/AAAAAAAAAAI/AAAAAAAAAAA/RCGcK9m4sHo/s48-c-k-no-mo-rj-c0xffffff/photo.jpg",
  description: "The President-elect shares an update on the Presidential Transition," +
    " an outline of some of his policy plans for the first 100 days, and his day one executive actions.",
  views: "1,341,158",
  comments: [],
  thumbnail: "https://i.ytimg.com/vi/7xX_KaStFT8/hqdefault.jpg?custom=true&w=196&h=110&stc=true&jpg444=true&jpgq=90&sp=68&sigh=sSuKCtqF5viHrZPjm2RfTsPvqNs",
  embed: 'https://www.youtube.com/embed/7xX_KaStFT8?autoplay=1'
},
{
  title: "Cars 3 Official US Teaser Trailer",
  channel: "Disney-Pixar",
  channelicon: "https://yt3.ggpht.com/-CmoaPOAkgk8/AAAAAAAAAAI/AAAAAAAAAAA/RCGcK9m4sHo/s48-c-k-no-mo-rj-c0xffffff/photo.jpg",
  description: "From this moment, everything will change.\n\nDisney/Pixar's Cars 3 opens in US theatres" +
    " in 3D June 16, 2017.\n\nBlindsided by a new generation of blazing-fast races, the legendary Lightning McQueen (voice of Owen" +
    " Wilson) is suddenly pushed out of the sport he loves. To get back in the game, he will need the help of" +
    " an eager young race technician, Cruz Ramirez, with her own plan to win, plus inspiration from the late Fabulous" +
    " Hudson Hornet and a few unexpected turns.",
  views: "3,258,307",
  comments: [],
  thumbnail: "https://i.ytimg.com/vi/E4K7JgPJ8-s/hqdefault.jpg?custom=true&w=196&h=110&stc=true&jpg444=true&jpgq=90&sp=68&sigh=DEWWRQJ38bHkSaBCT19c7Xeimnw",
  embed: 'https://www.youtube.com/embed/E4K7JgPJ8-s?autoplay=1'
},
{
  title: "Flip Edition | Dude Perfect",
  channel: "Dude Perfect",
  channelicon: "https://yt3.ggpht.com/-CmoaPOAkgk8/AAAAAAAAAAI/AAAAAAAAAAA/RCGcK9m4sHo/s48-c-k-no-mo-rj-c0xffffff/photo.jpg",
  description: "It's time to flip some stuff!\nThanks to Fantasitc Gymnastics by Hasbro Gaming for sponsoring" +
    " this video! Go to http://bit.ly/FantasticGymnasticsDP to get Fantastic Gymnastics for yourself!",
  views: "4,460,870",
  comments: [],
  thumbnail: "https://i.ytimg.com/vi/8YydogFXCPM/hqdefault.jpg?custom=true&w=196&h=110&stc=true&jpg444=true&jpgq=90&sp=68&sigh=MzABtab1-7LFj6m97B5xOS-lCgk",
  embed: 'https://www.youtube.com/embed/8YydogFXCPM?autoplay=1'
},
{
  title: "Billy on the Street: DEATH ROGEN! With Seth Rogen",
  channel: "billyonthestreettv",
  channelicon: "https://yt3.ggpht.com/-CmoaPOAkgk8/AAAAAAAAAAI/AAAAAAAAAAA/RCGcK9m4sHo/s48-c-k-no-mo-rj-c0xffffff/photo.jpg",
  description: "New from Billy on the Street! Watch Billy hit the street with SETH ROGEN in disguise, tell" +
    " people that Seth has died and get their reactions! We call this DEATH ROGEN. Watch full episodes of Billy on the Street Tuesdays at 10:30/9:30c on @TruTV!",
  views: "364,533",
  comments: [],
  thumbnail: "https://i.ytimg.com/vi/A2R2iBc8udc/hqdefault.jpg?custom=true&w=168&h=94&stc=true&jpg444=true&jpgq=90&sp=68&sigh=j7ivnsDvrCl-ucJWKLoscivhtrs",
  embed: 'https://www.youtube.com/embed/diN92St7FA8?autoplay=1'
},
{
  title: "Bullets vs Propeller in Slow Motion - The Slow Mo Guys",
  channel: "The Slow Mo Guys",
  channelicon: "https://yt3.ggpht.com/-CmoaPOAkgk8/AAAAAAAAAAI/AAAAAAAAAAA/RCGcK9m4sHo/s48-c-k-no-mo-rj-c0xffffff/photo.jpg",
  description: "Gary and Dan venture out to the desert to film some bullets. Make sure you watch in HD for maximum bullet" +
    " shockwave action!\nCheers to EA for sponsoring this video. Check out the game at http://www.battlefield.com\n" +
    "Follow Gav on Twitter - https://twitter.com/GavinFree\nFollow Dan on Twitter - https://twitter.com/DanielGruchy",
  views: "1,466,332",
  comments: [],
  thumbnail: "https://i.ytimg.com/vi/ysB-SH19WRQ/hqdefault.jpg?custom=true&w=196&h=110&stc=true&jpg444=true&jpgq=90&sp=68&sigh=9OEQLS6JSWBMQ8sCrd0yZt58lJ8",
  embed: 'https://www.youtube.com/embed/ysB-SH19WRQ?autoplay=1'
},
{
  title: 'The Voice 2016 Billy Gilman - Top 11: "All I Ask"',
  channel: "The Voice",
  channelicon: "https://yt3.ggpht.com/-CmoaPOAkgk8/AAAAAAAAAAI/AAAAAAAAAAA/RCGcK9m4sHo/s48-c-k-no-mo-rj-c0xffffff/photo.jpg",
  description: "Billy Gilman showcases his vocal talent with a powerful rendition of 'All I Ask' by Adele.\n\n" +
    "NBC's The Voice follows the strongest vocalists from across the country and invites them to compete in" +
    " this season's blockbuster vocal competition.",
  views: "213,615",
  comments: [],
  thumbnail: "https://i.ytimg.com/vi/RswuJVHVw_0/hqdefault.jpg?custom=true&w=196&h=110&stc=true&jpg444=true&jpgq=90&sp=68&sigh=6lmdPt82bEpmKOw202Zi67Iwk7U",
  embed: 'https://www.youtube.com/embed/RswuJVHVw_0?autoplay=1'
},
{
  title: "The iPhone 8 Will Be Incredible!",
  channel: "EverythingApplePro",
  channelicon: "https://yt3.ggpht.com/-CmoaPOAkgk8/AAAAAAAAAAI/AAAAAAAAAAA/RCGcK9m4sHo/s48-c-k-no-mo-rj-c0xffffff/photo.jpg",
  description: "iPhone 8 & 8 Plus Rumors & Leaks Have Begun! New Features To Expect & Rumor Roundup With Sources!",
  views: "693,167",
  comments: [],
  thumbnail: "https://i.ytimg.com/vi/MZqyfeUi7As/hqdefault.jpg?custom=true&w=196&h=110&stc=true&jpg444=true&jpgq=90&sp=68&sigh=HDgDRvuiwhCcMHXVT0Gm9eukqU8",
  embed: 'https://www.youtube.com/embed/MZqyfeUi7As?autoplay=1'
},
{
  title: "10 Disney Crossover Easter Eggs That You've Never Seen",
  channel: "Screen Rant",
  channelicon: "https://yt3.ggpht.com/-CmoaPOAkgk8/AAAAAAAAAAI/AAAAAAAAAAA/RCGcK9m4sHo/s48-c-k-no-mo-rj-c0xffffff/photo.jpg",
  description: "Animated movies are a right of passage for most children, and nobody does them better than Disney. Every child remembers watching Snow White and" +
    " The Little Mermaid for the first time, and most of us are still heading to theatres whenever a new Pixar film comes out. But we don't always catch the Easter" +
    " eggs left there by mischievious animators, or the cameos that some Disney characters make in movies that aren't their own.",
  views: "260,853",
  comments: [],
  thumbnail: "https://i.ytimg.com/vi/KBTwUOsO4d0/hqdefault.jpg?custom=true&w=196&h=110&stc=true&jpg444=true&jpgq=90&sp=68&sigh=Ue_RmuQ0uggRmpbxvxQAiC-w060",
  embed: 'https://www.youtube.com/embed/KBTwUOsO4d0?autoplay=1'
}];
var users = [{
  name: "User1",
  icon: "http://simpleicon.com/wp-content/uploads/user1.png"
},
{
  name: "User2",
  icon: "https://cdn0.iconfinder.com/data/icons/PRACTIKA/256/user.png"
},
{
  name: "User3",
  icon: "http://downloadicons.net/sites/default/files/women-business-user-icon-44928.png"
},
{
  name: "User4",
  icon: "https://cdn0.iconfinder.com/data/icons/PRACTIKA/256/user.png"
}];


// Deletes all of the children associated with the provided element ID.
function deleteChild(_element) {
  while (_element.hasChildNodes()) {
    _element.removeChild(_element.lastChild);
  }
}


// Helper function to create elements with a specified id/class
function newElement(_type, _attribute1, _attribute2) {
  if (!_type) return;
  var $element = document.createElement(_type);

  if (!_attribute1 || !_attribute2) return $element;
  $element.setAttribute(_attribute1, _attribute2);

  return $element;
}


// Return an array of matched video objects based on user query.
function findMatch(_query) {
  var videoList = [];

  for (var index = 0; index < videos.length; index++) {
    var itemText = videos[index].description + videos[index].title + videos[index].channel;
    if (itemText.toLowerCase().includes(_query.toLowerCase())) {
      videoList.push(videos[index]);
    }
  }

  return videoList;
}


// Builds video list with videos that match the user's search query
function buildVideoList(_elements) {
  var $videoList = document.getElementById('videos');
  var $videoBlock = newElement('div', 'id', 'videoblock');

  $videoList.appendChild($videoBlock);

  for (var index = 0; index < _elements.length; index++) {
    var $videoDetails = newElement('div', 'id', 'videodetails');
    var $videoImage = newElement('img', 'class', 'videoimg');
    var $videoTitle = newElement('h4', 'class', 'videotitle');
    var $videoChannel = newElement('p', 'class', 'videochannel');
    var $videoViews = newElement('p', 'class', 'videoviews');
    var $videoDesc = newElement('p', 'class', 'videodesc');
    var $link1 = newElement('a', 'href', '#');
    var $link2 = newElement('a', 'href', '#');

    $videoBlock.appendChild($videoDetails);

    $videoImage.setAttribute('src', _elements[index].thumbnail);
    $videoImage.setAttribute('data-embed', _elements[index].embed);
    $videoDetails.appendChild($link1);
    $link1.appendChild($videoImage);

    $videoTitle.textContent = _elements[index].title;
    $videoTitle.setAttribute('data-embed', _elements[index].embed);
    $videoDetails.appendChild($link2);
    $link2.appendChild($videoTitle);

    $videoChannel.textContent = _elements[index].channel;
    $videoDetails.appendChild($videoChannel);

    $videoViews.textContent = _elements[index].views + " views";
    $videoDetails.appendChild($videoViews);

    $videoDesc.textContent = _elements[index].description;
    $videoDetails.appendChild($videoDesc);
  }
}


// Builds the video viewing area containing video related details
function buildViewingArea(_embed) {
  var $videos = document.getElementById('videos');
  var $viewingArea = newElement('div', 'id', 'viewingarea');
  var $embed = newElement('div', 'id', 'embed');
  var $showVideo = newElement('iframe', 'width', '560px');

  $showVideo.setAttribute('height', '480px');
  $showVideo.setAttribute('width', '854px');
  $showVideo.setAttribute('src', _embed);
  $showVideo.setAttribute('frameborder', 0);
  $showVideo.setAttribute('allowfullscreen', '');
  $showVideo.setAttribute('id', 'uservideo');
  $videos.appendChild($viewingArea);
  $viewingArea.appendChild($embed);
  $embed.appendChild($showVideo);

  var $videoinfo = newElement('div', 'id', 'videoinfo');
  var $titlebox = newElement('div', 'id', 'titlebox');
  var $title = newElement('h2', 'class', 'title');
  var $channelbox = newElement('div', 'id', 'channelbox');
  var $channel = newElement('p', 'class', 'channel');
  var $channelicon = newElement('img', 'class', 'videoicon');
  var $description = newElement('p', 'class', 'desc');
  var $views = newElement('p', 'class', 'views');

  $videos.appendChild($videoinfo);

  var index = findVideo(_embed);
  var title = videos[index].title;
  var channel = videos[index].channel;
  var channelicon = videos[index].channelicon;
  var description = videos[index].description;
  var views = videos[index].views;

  $title.textContent = title;
  $channel.textContent = channel;
  $channelicon.setAttribute('src', channelicon);
  $description.textContent = description;
  $views.textContent = views + " views";

  $videoinfo.appendChild($titlebox);
  $titlebox.appendChild($title);
  $videoinfo.appendChild($channelbox);
  $channelbox.appendChild($channelicon);
  $channelbox.appendChild($channel);
  $videoinfo.appendChild($views);
  $videoinfo.appendChild($description);

  var $commentBox = newElement('div', 'id', 'commentbox');
  var $commentWrapper = newElement('div', 'class', 'wrap');
  var $commentHeader = newElement('h4', 'class', 'header');
  var $comment = newElement('form', '', '');
  var $commentInput = newElement('textarea', 'class', 'input');
  var $userIcon = newElement('img', 'src', users[1].icon);
  var $div = newElement('div', '', '');

  $comment.setAttribute('action','');
  $commentHeader.textContent = "COMMENTS • " + videos[index].comments.length;
  $commentInput.setAttribute('placeholder', 'Add a public comment...');
  $commentInput.setAttribute('type', 'text');
  $commentInput.setAttribute('name', 'comment');
  $userIcon.setAttribute('class', 'icon');
  $videos.appendChild($commentBox);
  $commentBox.appendChild($commentHeader);
  $commentBox.appendChild($commentWrapper);
  $commentWrapper.appendChild($userIcon);
  $commentWrapper.appendChild($comment);
  $comment.appendChild($commentInput);
}


// Comment object constructor
function Comment(_user, _icon, _age, _comment) {
  this.user = _user;
  this.icon = _icon;
  this.age = _age;
  this.comment = _comment;
}


// Helper function that returns index of target video in video database
function findVideo(_embed) {
  for (var index = 0; index < videos.length; index++) {
    if (videos[index].embed === _embed) {
      return index;
    }
  }
}


// Adds a new comment to the current video
function addComment(_video, _user) {
  //var comment = new Comment(_user.name, _user.icon, 2000)
  //videos[_target].comments.push()
}


document.addEventListener('submit', function(_event) {

  _event.preventDefault();

  var query = document.getElementById('searchbar').value;

  if (query.trim()) {
    query = query.trim();
    var videoList = findMatch(query);
    var $videoBlock = newElement('div', 'class', 'videoblock');
    var $videos = document.getElementById('videos');

    $videos.appendChild($videoBlock);

    deleteChild($videos);

    if (videoList.length > 0) {
      buildVideoList(videoList);
    }
    else {
      var $invalidSearch = newElement('h2', 'id', 'invalidsearch');

      $invalidSearch.textContent = 'No results found for: ' + query + '.';
      $videos.appendChild($invalidSearch);
    }
  }
  else return;

});


document.addEventListener('click', function(_event) {
  var $target = _event.target;
  if ($target.className === 'videoimg' || $target.className === 'videotitle') {
    _event.preventDefault();

    var $videos = document.getElementById('videos');
    var embedURL = $target.getAttribute("data-embed");

    deleteChild($videos);

    buildViewingArea(embedURL);
  }
});
